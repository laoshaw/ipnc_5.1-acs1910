<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
				<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="mediawiki-tip/opensearch_desc.php" title="RTSC-Pedia (English)" />
		<title>Using xdc.runtime Startup/TI - Offline Version</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "../common/skins/common/shared.css";
			@import "../common/skins/monobook/main.css";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../common/skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "../common/skins/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "../common/skins/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "../common/skins/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "../common/skins/monobook/IE70Fixes.css";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="../common/skins/common/IEFixes.js?97"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "../common/skins";
var wgArticlePath = "/docs-tip/$1";
var wgScriptPath = "mediawiki-tip";
var wgScript = "mediawiki-tip/index.php";
var wgServer = "http://rtsc.eclipse.org";
var wgCanonicalNamespace = "Special";
var wgCanonicalSpecialPageName = "Offline";
var wgNamespaceNumber = -1;
var wgPageName = "Special:Offline";
var wgTitle = "Offline";
var wgAction = "view";
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
var wgArticleId = 0;
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = 0;
/*]]>*/</script>
                
		<script type="text/javascript" src="../common/skins/common/wikibits.js?97"><!-- wikibits js --></script>
		<script type="text/javascript" src="mediawiki-tip/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "mediawiki-tip/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "mediawiki-tip/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "mediawiki-tip/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>
		<!-- Head Scripts -->
<link rel="stylesheet" type="text/css" href="../common/extensions/rtsc/ViewStyle.css" /><link rel="stylesheet" type="text/css" href="../common/extensions/rtsc/MainStyle.css" />
	</head>
<body  class="mediawiki ns--1 ltr page-Special_Offline">
	<div id="globalWrapper" align="center">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading"></h1>
		<div id="bodyContent">
			<h3 id="siteSub">From RTSC-Pedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content --><div id="revInfo">revision tip</div><span id="printInfo">&#151;&#151;&nbsp;LANDSCAPE orientation</span><table width="100%"><tr><td class="lights"><img src="../common/extensions/rtsc/images/yellow_light.png" /></td><td class="offline">[<a href="/mediawiki-tip/index.php?title=Using xdc.runtime Startup/TI&amp;printable=yes" title="just this page in black-and-white, ready for printing in landscape orientation">printable version</a>]&nbsp;&nbsp;</td><td class="offlineDate">offline version generated on 02-Oct-2009 22:10 UTC</td><td class="arrows"><a href="Using_xdc.runtime_Startup.html#TOC" title="Using xdc.runtime Startup"><img src="../common/extensions/rtsc/images/Arrow_up.png" /></a>&nbsp;<a href="Using_xdc.runtime_Startup__GNU.html" title="GNU"><img src="../common/extensions/rtsc/images/Arrow_right.png" /></a></td></tr></table><p id="title">Using xdc.runtime Startup/TI</p><p id="subtitle">How Texas Instruments targets bootstrap</p>
<p></p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a>
<ul>
<li class="toclevel-2"><a href="#Initialize_Registers"><span class="tocnumber">1.1</span> <span class="toctext">Initialize Registers</span></a>
<ul>
<li class="toclevel-3"><a href="#C6000"><span class="tocnumber">1.1.1</span> <span class="toctext">C6000</span></a></li>
<li class="toclevel-3"><a href="#C2000"><span class="tocnumber">1.1.2</span> <span class="toctext">C2000</span></a></li>
<li class="toclevel-3"><a href="#ARM"><span class="tocnumber">1.1.3</span> <span class="toctext">ARM</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#User_Reset_Function"><span class="tocnumber">1.2</span> <span class="toctext">User Reset Function</span></a></li>
<li class="toclevel-2"><a href="#Process_.cinit_Records"><span class="tocnumber">1.3</span> <span class="toctext">Process .cinit Records</span></a></li>
<li class="toclevel-2"><a href="#Start_Modules"><span class="tocnumber">1.4</span> <span class="toctext">Start Modules</span></a></li>
<li class="toclevel-2"><a href="#Process_.pinit_Records"><span class="tocnumber">1.5</span> <span class="toctext">Process .pinit Records</span></a></li>
<li class="toclevel-2"><a href="#Main.28.29_Function"><span class="tocnumber">1.6</span> <span class="toctext">Main() Function</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Introduction"></a><h2> <span class="mw-headline">Introduction</span></h2>
<p>The boot sequence for each target is implemented in the xdc runtime support package named by the target; see <a href="../../cdoc/xdc/bld/ITarget.html#rts" class="cdoc"><tt>xdc.bld.ITarget.rts</tt></a>.  This package contains both a compiled version of the <tt>xdc.runtime</tt> package's modules and any necessary bootstrap code.
</p><p><img src="../common/extensions/rtsc/images/hand.png" />  The xdc runtime support package and the TI C Compiler RTS Library are not the same.  The TI C Compiler RTS Library contains an implementation of the C Standard Library as required by the ANSI C Language.  The xdc runtime support package bootstrap code and pre-compiled versions of the modules contained in the <tt>xdc.runtime</tt> package.  In some cases, the <tt>xdc.runtime</tt> package's modules call functions specified by the ANSI C Language which, for TI targets, is provided in the TI C Compiler RTS Library.
</p><p>In the sections that follow, we outline in detail the initialization process common to all TI targets.
</p>
<a name="Initialize_Registers"></a><h3> <span class="mw-headline">Initialize Registers</span></h3>
<p>Execution on TI targets always starts at <tt>_c_int00</tt>, which is plugged as the
reset vector. The boot sequence begins with the initialization of a few critical
registers, including the system stack pointer. This part of the sequence is
target-specific.
</p><p>For a detailed view of the initial register setup, the actual boot code is
available in the <tt>XDCtools</tt> installation. On all targets, the relevant portion of the
boot code (in terms of the initial register setup) occurs between <tt>_c_int00</tt>
(where execution starts) and the call to the <tt>xdc_runtime_Startup_reset()</tt>
function. Boot code for any other targets should be available in a similar
location, inside the "rts" folder for that target.
</p><p>The following sections show what register initialization occurs for each target
and where the actual boot code is located:
</p>
<a name="C6000"></a><h4> <span class="mw-headline">C6000</span></h4>
<ul><li>Clear the IER and IFR.
</li><li>Set the system stack pointer (B15) to point to the end of the stack section.
</li><li>Set the global page pointer (B14) to point to the beginning of the .bss section.
</li><li>On C6700 class processors, also set the floating point registers.
</li></ul>
<p>The c6000 boot code is available in <tt>boot.c</tt> contained in the <tt>ti.targets.rts6000</tt> package
The <tt>auto_init()</tt> function is defined in <tt>autoinit.c</tt> in the same package.
</p>
<a name="C2000"></a><h4> <span class="mw-headline">C2000</span></h4>
<p>Set up the stack, initialize any status bits not initialized by the reset, and set
the C28x modes.
The c2000 boot code is available in the <tt>boot_cg.asm</tt> file contained in the <tt>ti.targets.rts2800</tt> package.
</p>
<a name="ARM"></a><h4> <span class="mw-headline">ARM</span></h4>
<p>Set user mode, change to 16-bit state, and initialize and align the user mode
stack.
</p><p>The arm7 (arm9) boot code is available in the <tt>boot.asm</tt> file contained in the <tt>ti.targets.arm.rtsarm7</tt> (<tt>ti.targets.arm.rtsarm9</tt>) package.
</p>
<a name="User_Reset_Function"></a><h3> <span class="mw-headline">User Reset Function</span></h3>
<p>The reset function is the first control point in the boot sequence. It occurs
almost immediately after the target has been reset. The user-specified reset
function is called after the initial register initialization, but before even the <tt>.cinit</tt>
records have been processed. Any code that needs to be executed
immediately after a reset, such as configuring or disabling a watchdog timer,
should occur here.
</p><p>The <tt>Startup</tt> module has a module-wide configuration parameter called
<tt>resetFxn</tt>, which specifies the function to run at this point.  The following example <tt class="color-red" style="font-size:110%; font-weight:bold;">XDCscript</tt> configuration
script demonstrates the Startup module's use:
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> Startup = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st1">'xdc.runtime.Startup'</span><span class="br0">&#41;</span>;
Startup.resetFxn = <span class="st0">&quot;&amp;myResetFxn&quot;</span>;</pre></td></tr></table>
<p>Note that the "&amp;" isn't actually being used as an operator in these statements;
it's just part of a string. Internally, <tt class="color-red" style="font-size:110%; font-weight:bold;">XDCscript</tt> knows to interpret the characters after
the &amp; as the name of an external user-supplied function.
</p><p>The <tt>resetFxn</tt> is called before the <tt>.cinit</tt> records have been processed, so no
data structures or variables have been loaded with their initial values at this
point.
</p>
<a name="Process_.cinit_Records"></a><h3> <span class="mw-headline">Process <tt>.cinit</tt> Records</span></h3>
<p>For each statically initialized variable, TI targets generate a "<tt>.cinit</tt> record" that contains the location of the variable in memory and its initial value.  These records are gathered together (in no particular order) to form a special <tt>.cinit</tt> output section that is part of the resulting object file.  This section may be loaded onto the target and processed during the target's bootstrap or it may be read and processed directly by the application's loader.  The choice between these two options is controlled by the <tt>-r</tt> option passed to the TI linker. 
</p><p>If the <tt>.cinit</tt> section is processed by the target's bootstrap, it occurs <i>after</i> the <tt>resetFxn</tt> and before any modules are initialized.  So, module startup functions may assume that the C environment has been fully initialized but the <tt>resetFxn</tt> can not.
</p>
<a name="Start_Modules"></a><h3> <span class="mw-headline">Start Modules</span></h3>
<p>At this point, the boot sequence calls the <tt>xdc_runtime_Startup_exec()</tt> function. This function then calls all the module startup functions (<tt><i>Mod</i>_Module_startup</tt>) for each module <tt><i>Mod</i></tt> that was declared as "used" during the configuration process.  The <tt>Startup</tt> module has two module-wide configuration parameters:
<tt>firstFxns</tt> and <tt>lastFxns</tt>, which are arrays of user-specified functions to be called before and after the module startup functions, respectively.
</p><p>The following example <tt class="color-red" style="font-size:110%; font-weight:bold;">XDCscript</tt> configuration statements specify functions to be called with the <tt>firstFxns</tt> and <tt>lastFxns</tt>
parameters.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> Startup = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st1">'xdc.runtime.Startup'</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> len = Startup.firstFxns.length;
Startup.firstFxns.length++;
Startup.firstFxns<span class="br0">&#91;</span>len<span class="br0">&#93;</span> = <span class="st1">'&amp;myFirst'</span>;
<span class="kw1">var</span> len = Startup.lastFxns.length;
Startup.lastFxns.length++;
Startup.lastFxns<span class="br0">&#91;</span>len<span class="br0">&#93;</span> = <span class="st1">'&amp;myLast'</span>;</pre></td></tr></table>
<p>Functions added to "firstFxns" typically initialize values needed by module startup functions&#151;such as initialization of global data used by modules, which is a function of platform-specific registers. Functions added to the "lastFxns" array might be used by middleware or other modules to perform any necessary initialization before <tt>main()</tt>.
</p>
<a name="Process_.pinit_Records"></a><h3> <span class="mw-headline">Process .pinit Records</span></h3>
<p>After the module startup functions have run, the <tt>.pinit</tt> records are processed.
The <tt>.pinit</tt> table consists of pointers to initialization functions. For C++
programs, class constructors of global objects execute during <tt>.pinit</tt>
processing.
</p><p>Note that the module initialization in the previous section may occur in the
middle of <tt>.pinit</tt> processing. So, C++ constructors that require the services of
a module must explicitly call <tt>Startup_exec()</tt> prior to using any module.
</p>
<a name="Main.28.29_Function"></a><h3> <span class="mw-headline">Main() Function</span></h3>
<p>Finally, the startup function call the <tt>main()</tt> function with an argument count and an array of argument strings. The argument strings are stored on the target and initialized by the user's loader.
</p>
<table width="100%"><tr><td class="lights"><img src="../common/extensions/rtsc/images/yellow_light.png" /></td><td class="offline">[<a href="/mediawiki-tip/index.php?title=Using xdc.runtime Startup/TI&amp;printable=yes" title="just this page in black-and-white, ready for printing in landscape orientation">printable version</a>]&nbsp;&nbsp;</td><td class="offlineDate">offline version generated on 02-Oct-2009 22:10 UTC</td><td class="arrows"><a href="Using_xdc.runtime_Startup.html#TOC" title="Using xdc.runtime Startup"><img src="../common/extensions/rtsc/images/Arrow_up.png" /></a>&nbsp;<a href="Using_xdc.runtime_Startup__GNU.html" title="GNU"><img src="../common/extensions/rtsc/images/Arrow_right.png" /></a></td></tr></table><div id=copyInfo>Copyright &#169; 2008 The Eclipse Foundation. All Rights Reserved</div>
<!-- 
Pre-expand include size: 1270 bytes
Post-expand include size: 745 bytes
Template argument size: 93 bytes
Maximum: 2097152 bytes
-->

			<div class="printfooter">
Retrieved from "<a href="http://rtsc.eclipse.org/docs-tip/Special:Offline">http://rtsc.eclipse.org/docs-tip/Special:Offline</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
					 <li id="ca-nstab-special" class="selected"><a href="../Special:Offline/Special:Offline__Using_xdc.runtime_Startup.html" title="This is a special page, you can't edit the page itself">Special</a></li>
				</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="mediawiki-tip/index.php?title=Special:Userlogin&amp;returnto=Special:Offline" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../common/extensions/rtsc/images/logo.png);" href="/docs-tip/Main_Page" title="Visit the Main Page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-RTSC-pedia-home"><a href="../Main_Page/Main_Page.html">RTSC-pedia home</a></li>
				<li id="n-RTSC-project-home"><a href="http://rtsc.eclipse.org ">RTSC project home</a></li>
				<li id="n-News-.26-support"><a href="http://www.eclipse.org/newsportal/thread.php?group=eclipse.dsdp.rtsc">News &amp; support</a></li>
				<li id="n-Help"><a href="../Help:Contents/Help:Contents.html">Help</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-binders'>
		<h5>binders</h5>
		<div class='pBody'>
			<ul>
				<li id="n-General-Information"><a href="../General_Information/General_Information.html">General Information</a></li>
				<li id="n-RTSC-Programming"><a href="../RTSC_Programming/RTSC_Programming.html">RTSC Programming</a></li>
				<li id="n-User.27s-Guide"><a href="../XDCtools_User%27s_Guide/XDCtools_User%27s_Guide.html">User's Guide</a></li>
				<li id="n-Reference-Manual"><a href="../XDCtools_Reference_Manual/XDCtools_Reference_Manual.html">Reference Manual</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-package_reference'>
		<h5>package reference</h5>
		<div class='pBody'>
			<ul>
				<li id="n-XDCtools-packages"><a href="http://rtsc.eclipse.org/cdoc-tip/index.html ">XDCtools packages</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-lists'>
		<h5>lists</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Master-doc-map"><a href="../Special:DocMap/Special:DocMap__Main_Page.html">Master doc-map</a></li>
				<li id="n-Category-query"><a href="../Special:Cats/Special:Cats.html">Category query</a></li>
				<li id="n-Redirected-pages"><a href="../Special:Listredirects/Special:Listredirects.html">Redirected pages</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-tools'>
		<h5>tools</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Find.2BReplace-.28grep.29"><a href="../Special:Grep/Special:Grep.html">Find+Replace (grep)</a></li>
				<li id="n-RSS-feed"><a href="http://rtsc.eclipse.orgmediawiki-tip/index.php?title=Special:Recentchanges&amp;feed=rss ">RSS feed</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/docs-tip/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search RTSC-Pedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>more tools</h5>
		<div class="pBody">
			<ul>
<li id="t-upload"><a href="../Special:Upload/Special:Upload.html" title="Upload images or media files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="../Special:Specialpages/Special:Specialpages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../common/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="privacy"><a href="../RTSC-Pedia:Privacy_policy/RTSC-Pedia:Privacy_policy.html" title="RTSC-Pedia:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="../RTSC-Pedia:About/RTSC-Pedia:About.html" title="RTSC-Pedia:About">About RTSC-Pedia</a></li>
				<li id="disclaimer"><a href="../RTSC-Pedia:General_disclaimer/RTSC-Pedia:General_disclaimer.html" title="RTSC-Pedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served in 0.234 secs. --></body></html>
