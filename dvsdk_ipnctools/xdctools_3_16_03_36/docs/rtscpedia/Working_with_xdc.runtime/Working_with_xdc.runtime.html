<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
				<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="mediawiki-tip/opensearch_desc.php" title="RTSC-Pedia (English)" />
		<title>Working with xdc.runtime - Offline Version</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "../common/skins/common/shared.css";
			@import "../common/skins/monobook/main.css";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../common/skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "../common/skins/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "../common/skins/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "../common/skins/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "../common/skins/monobook/IE70Fixes.css";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="../common/skins/common/IEFixes.js?97"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "../common/skins";
var wgArticlePath = "/docs-tip/$1";
var wgScriptPath = "mediawiki-tip";
var wgScript = "mediawiki-tip/index.php";
var wgServer = "http://rtsc.eclipse.org";
var wgCanonicalNamespace = "Special";
var wgCanonicalSpecialPageName = "Offline";
var wgNamespaceNumber = -1;
var wgPageName = "Special:Offline";
var wgTitle = "Offline";
var wgAction = "view";
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
var wgArticleId = 0;
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = 0;
/*]]>*/</script>
                
		<script type="text/javascript" src="../common/skins/common/wikibits.js?97"><!-- wikibits js --></script>
		<script type="text/javascript" src="mediawiki-tip/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "mediawiki-tip/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "mediawiki-tip/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "mediawiki-tip/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>
		<!-- Head Scripts -->
<link rel="stylesheet" type="text/css" href="../common/extensions/rtsc/ViewStyle.css" /><link rel="stylesheet" type="text/css" href="../common/extensions/rtsc/MainStyle.css" />
	</head>
<body  class="mediawiki ns--1 ltr page-Special_Offline">
	<div id="globalWrapper" align="center">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading"></h1>
		<div id="bodyContent">
			<h3 id="siteSub">From RTSC-Pedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content --><div id="revInfo">revision tip</div><span id="printInfo">&#151;&#151;&nbsp;LANDSCAPE orientation</span><table width="100%"><tr><td class="lights"><img src="../common/extensions/rtsc/images/yellow_light.png" /></td><td class="offline">[<a href="/mediawiki-tip/index.php?title=Working with xdc.runtime&amp;printable=yes" title="just this page in black-and-white, ready for printing in landscape orientation">printable version</a>]&nbsp;&nbsp;[<a href="/mediawiki-tip/index.php?title=Special:Offline/Working with xdc.runtime" title="a standalone HTML bundle of this entire document, ready for download">offline version</a>]</td><td class="offlineDate">offline version generated on 02-Oct-2009 22:10 UTC</td><td class="arrows"><a href="../XDCtools_User's_Guide/XDCtools_User's_Guide.html" title="XDCtools User's Guide"><img src="../common/extensions/rtsc/images/Arrow_up.png" /></a></td></tr></table><p id="title">Working with xdc.runtime</p><p id="subtitle">How to build xdc.runtime for your target and platform</p>
<p></p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1"><a href="#Re-building_xdc.runtime_Support_Packages"><span class="tocnumber">2</span> <span class="toctext">Re-building xdc.runtime Support Packages</span></a>
<ul>
<li class="toclevel-2"><a href="#Re-building_in-place"><span class="tocnumber">2.1</span> <span class="toctext">Re-building in-place</span></a></li>
<li class="toclevel-2"><a href="#Re-building_a_local_copy_.28recommended.29"><span class="tocnumber">2.2</span> <span class="toctext">Re-building a local copy (recommended)</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Multi-Threading_Support"><span class="tocnumber">3</span> <span class="toctext">Multi-Threading Support</span></a></li>
<li class="toclevel-1"><a href="#Porting_to_a_New_Target"><span class="tocnumber">4</span> <span class="toctext">Porting to a New Target</span></a>
<ul>
<li class="toclevel-2"><a href="#package.xdc"><span class="tocnumber">4.1</span> <span class="toctext">package.xdc</span></a></li>
<li class="toclevel-2"><a href="#package.bld"><span class="tocnumber">4.2</span> <span class="toctext">package.bld</span></a></li>
<li class="toclevel-2"><a href="#Testing_Your_New_Target"><span class="tocnumber">4.3</span> <span class="toctext">Testing Your New Target</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Removing_xdc.runtime_From_an_Application"><span class="tocnumber">5</span> <span class="toctext">Removing xdc.runtime From an Application</span></a></li>
<li class="toclevel-1"><a href="#Using_a_Customized_Build_of_xdc.runtime"><span class="tocnumber">6</span> <span class="toctext">Using a Customized Build of xdc.runtime</span></a></li>
<li class="toclevel-1"><a href="#Using_xdc.runtime_Within_C-Only_Environments"><span class="tocnumber">7</span> <span class="toctext">Using xdc.runtime Within C-Only Environments</span></a>
<ul>
<li class="toclevel-2"><a href="#Rebuilding_Just_the_C_Sources"><span class="tocnumber">7.1</span> <span class="toctext">Rebuilding Just the C Sources</span></a></li>
<li class="toclevel-2"><a href="#Use_This_New_Build_of_xdc.runtime"><span class="tocnumber">7.2</span> <span class="toctext">Use This New Build of xdc.runtime</span></a></li>
<li class="toclevel-2"><a href="#Manually_Initializing_All_RTSC_Modules"><span class="tocnumber">7.3</span> <span class="toctext">Manually Initializing All RTSC Modules</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Introduction"></a><h2> <span class="mw-headline">Introduction</span></h2>
<p>This section contains topics related to the "manipulation" and use of <tt>xdc.runtime</tt> package as a whole rather than individual modules within this package.  For a basic overview of the <tt>xdc.runtime</tt> package see <a href="../Overview_of_xdc.runtime/Overview_of_xdc.runtime.html" title="Overview of xdc.runtime">Overview of xdc.runtime</a>.
</p>
<a name="Re-building_xdc.runtime_Support_Packages"></a><h2> <span class="mw-headline">Re-building <tt>xdc.runtime</tt> Support Packages </span></h2>
<p>The <tt>xdc.runtime</tt> package contains 100% portable ANSI C sources but does <i>not</i> include any precompiled libraries of these sources.  However, pre-built libraries are generally provided in separate packages named by the <a href="../Glossary/Glossary.html#Target" title="Glossary">targets</a> you're using; whenever you configure an application you must name a target and this target names a default package containing a pre-built library of the <tt>xdc.runtime</tt> sources.  In most cases, the packages containing these pre-built libraries are sufficient and there is no need to rebuild these packages.  But, there are times when it's necessary:
</p>
<ul><li> if you are using a different version of the compiler originally used to build the library and your compiler is unable to use the previously built library; because of an incompatible object file format change, for example. 
</li><li> if you need to use a new version of the <tt>xdc.runtime</tt> package
</li></ul>
<a name="Re-building_in-place"></a><h6> <span class="mw-headline"> Re-building in-place</span></h6>
<p><span class="Leader"> Re-building in-place</span>.&nbsp;  The simplest way to rebuild any source package is to simply clean and rebuild from the package's <a href="../Glossary/Glossary.html#Base_Directory" title="Glossary">base directory</a>.  In the example below, we assume that the package you need to re-build is named <tt>ti.targets.rts6000</tt>.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% cd .../packages/ti/targets/rts6000</span></b>
<b><span class="st0">% xdc clean</span></b>
<b><span class="st0">% xdc</span></b></pre></td></tr></table>
<p>You should see all of the modules in the <tt>xdc.runtime</tt> package being compiled and archived without any errors or warnings.
</p>
<p></p>
<p><div class="Notice"><p class="Notice">You should always maintain a backup copy of any package you modify.  In the example above, the "<tt>xdc clean</tt>" operation may remove support for targets that you don't currently use but may want to use at a later date.</p></div></p>
<a name="Re-building_a_local_copy_.28recommended.29"></a><h6> <span class="mw-headline"> Re-building a local copy (recommended)</span></h6>
<p><span class="Leader"> Re-building a local copy (recommended)</span>.&nbsp;  Most development groups prefer to keep all third-party packages unchanged from there original installation state.  This makes it much easier to accept and use updates of these packages from the third-party.  Fortunately, the package path allows you to easily "override" any existing package with a local version.  As before, we assume that the package you need to re-build is named <tt>ti.targets.rts6000</tt> but in this case we first need to create a copy of this package in a separate <a href="../Glossary/Glossary.html#Repository" title="Glossary">repository</a> denoted by "<tt>.../local</tt>".
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% mkdir -p .../local/ti/targets/rts6000</span></b>
<b><span class="st0">% cp -rp .../packages//ti/targets/rts6000 .../local/ti/targets/rts6000</span></b></pre></td></tr></table>
<div class="Info"><p class="Info">We could have used <tt><a href="../../cdoc/xdc/tools/repoman/package.html" class="cdoc"><tt>xdc.tools.repoman</tt></a></tt> or <tt><a href="../../cdoc/index.html#xdc/tools/repoman/sg/package.html" class="cdoc"><tt>xdc.tools.repoman.sg</tt></a></tt> to copy the <tt>ti.targets.rts6000</tt> package, but we intentionally chose to use familiar file system commands to keep the process as transparent as possible.  The <tt>repoman</tt> command to copy the package shown above is "<tt>xs xdc.tools.repoman -c -p .../packages -r .../local ti.targets.rts6000</tt>", where <tt>.../packages</tt> is the repository containing the <tt>ti.targets.rts6000</tt> package.</p></div>
<p>Now that we have a local copy of the <tt>ti.targets.rts6000</tt> package, the process to re-build is identical to the process shown to build the package in-place.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% cd .../local/ti/targets/rts6000</span></b>
<b><span class="st0">% xdc clean</span></b>
<b><span class="st0">% xdc</span></b></pre></td></tr></table>
<p>To use this newly re-built package in lieu of any existing version, simply place the "<tt>.../local</tt>" repository at the beginning of your <a href="../Glossary/Glossary.html#Package_Path" title="Glossary">package path</a>.
</p>
<table>

<tr valign="top">
<td><table cellpadding="0" cellspacing="0" class="codex"><tr><td class="codexLab"></td><td class="codexName"><tt>Windows</tt></td></tr><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% set XDCPATH=.../local</span></b></pre></td></tr></table>
</td><td><table cellpadding="0" cellspacing="0" class="codex"><tr><td class="codexLab"></td><td class="codexName"><tt>Unix</tt></td></tr><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% export XDCPATH=.../local</span></b></pre></td></tr></table>
</td></tr></table>
<p>For more information about managing the package path see <a href="../Managing_the_Package_Path/Managing_the_Package_Path.html" title="Managing the Package Path">Managing the Package Path</a>.
</p><p><span id="MultiThreadingSupport">
</p>
<a name="Multi-Threading_Support"></a><h2> <span class="mw-headline">Multi-Threading Support</span></h2>
<p></span>
In order to be portable to <i>any</i> multi-threaded runtime (e.g., DSP/BIOS or posix), the <tt>xdc.runtime</tt> modules protect their critical sections with the <tt><a href="../../cdoc/xdc/runtime/Gate.html#enter.System" class="cdoc"><tt>Gate_enterSystem()</tt></a></tt> and <tt><a href="../../cdoc/index.html#xdc/runtime/Gate.html#leave.System" class="cdoc"><tt>Gate_leaveSystem()</tt></a></tt> methods.  These methods, in turn, use the mutex gate associated with the <tt>xdc.runtime.System</tt> module.
</p><p>Some RTOS providers automatically configure the <tt>xdc.runtime.System</tt> gate to ensure correct operation in a multi-threaded environment.  For example, if you use the <tt>ti.sysbios</tt> package, the following lines are automatically added to your configuration by the <tt>ti.sysbios</tt> package itself:
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> System = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.System&quot;</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> GateHwi = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;ti.sysbios.gates.GateHwi&quot;</span><span class="br0">&#41;</span>;
System.common$.gate = GateHwi.create<span class="br0">&#40;</span><span class="br0">&#41;</span>;</pre></td></tr></table>
<p><img src="../common/extensions/rtsc/images/warning.png" /> If the <tt>System</tt> gate is not configured by some package in the system, it will default to an instance of <tt>GateNull</tt>. Since <tt>GateNull</tt> provides <i>no</i> synchronization, it should only be used for modules that are never called by more than one thread at a time.  Multi-threaded applications must either 
</p>
<ol><li>configure the <tt>System</tt> module's gate with a mutex that serializes all threads that access the <tt>xdc.runtime</tt> modules, or
</li><li>ensure that there are no concurrent accesses to the <tt>xdc.runtime</tt> modules
</li></ol>
<p>The table below summarizes the synchronization requirements for the <tt>xdc.runtime</tt> modules.  Any modules not mentioned do not require synchronization.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tr>
<th align="center"> <b>Module</b>
</th><th align="center"> <b>Requires System gate?</b>
</th></tr>
<tr>
<td align="left"> <tt>Core</tt>
</td><td align="left"> yes, to maintain pre-module instance list.  Only called during instance create and delete
</td></tr>
<tr>
<td align="left"> <tt>Error</tt>
</td><td align="left"> yes, but only to detect errors that occur within error handlers.  <img src="../common/extensions/rtsc/images/warning.png" /> <tt>Error_print()</tt> is <i>not</i> protected by any gate and, as a result, concurrent calls to <tt>Error_print()</tt> will result in intermingled error output
</td></tr>
<tr>
<td align="left"> <tt>System</tt>
</td><td align="left"> only <tt>System_atexit()</tt> and during application termination
</td></tr>
<tr>
<td align="left"> <tt>Assert</tt>, <tt>Memory</tt>, <tt>Log</tt>, <tt>Diags</tt>, <tt>Text</tt>, <tt>Timestamp</tt>
</td><td align="left"> no
</td></tr>
<tr>
<td align="left"> <tt>HeapMin</tt>, <tt>HeapStd</tt>, <tt>SysMin</tt>, <tt>LoggerBuf</tt>
</td><td align="left"> yes
</td></tr>
<tr>
<td align="left"> <tt>SysStd</tt>
</td><td align="left"> no <img src="../common/extensions/rtsc/images/warning.png" /> requires a thread-safe ANSI C Standard Runtime library
</td></tr>
<tr>
<td align="left"> <tt>LoggerSys</tt>
</td><td align="left"> no <img src="../common/extensions/rtsc/images/warning.png" /> requires that <tt>System_putch()</tt> be thread-safe
</td></tr>
<tr>
<td align="left"> <tt>TimestampNull</tt>
</td><td align="left"> no
</td></tr></table>
<p><span id="AnchorPortingToNewTarget">
</p>
<a name="Porting_to_a_New_Target"></a><h2> <span class="mw-headline">Porting to a New Target</span></h2>
<p></span>
Most users will never have to port the <tt>xdc.runtime</tt> package to a new target.  If you are not adding a new target to the RTSC Build Model, you should skip this section.
</p><p>Each target names a target-specific package that has already compiled the <tt>xdc.runtime</tt> modules into a library.  Since targets can be added <i>without</i> requiring a re-release of the <tt>xdc.runtime</tt> package, the <tt>xdc.runtime</tt> package can not contain any pre-built libraries.  The <tt>xdc.runtime</tt> package's modules are provided in 100% portable C source form and each target names a target-specific package that contains pre-built libraries suitable for that target.
</p><p>To create a package that contains pre-built versions of the modules in the <tt>xdc.runtime</tt> package you need to:
</p>
<ol><li>create a new target for your compiler tool chain (say <tt>adi.targets.Blackfin</tt>) whose <tt><a href="../../cdoc/xdc/bld/ITarget.html#rts" class="cdoc"><tt>rts</tt></a></tt> parameter names a package that will house a compiled version of the <tt>xdc.runtime</tt> modules (say <tt>adi.targets.rtsblackfin</tt>)
</li><li>create the <tt>adi.targets.rtsblackfin</tt> package; i.e., create a directory named <tt>adi/targets/rtsblackfin</tt> containing a <tt>package.xdc</tt> file similar to that shown <a href="#AnchorPackageSpec" title="">below</a>.
</li><li>add a package build script (<tt>package.bld</tt> similar to the one shown <a href="#AnchorPackageBuild" title="">below</a>) to build this package for the new target 
</li><li>add the new target to your <tt>config.bld</tt> file and build <tt>adi.targets.rtsblackfin</tt> package by typing <tt>xdc</tt> in the package's base.
</li></ol>
<p><span id="AnchorPackageSpec">
</p>
<a name="package.xdc"></a><h3> <span class="mw-headline">package.xdc</span></h3>
<p></span>
The package specification below both names the package, <tt>adi.targets.rtsblackfin</tt>, and provides a basic description of the package that will be displayed by the <a href="../Command_-_xdc.tools.cdoc.sg/Command_-_xdc.tools.cdoc.sg.html" title="Command - xdc.tools.cdoc.sg"><tt>xdc.tools.cdoc.sg</tt></a> command.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcspec"><span class="xdoc">/*!
 *  Pre-built xdc.runtime libraries for ADI blackfin targets
 *
 *  This package builds all xdc.runtime modules and provides all necessary 
 *  support for using the xdc.runtime package on ADI blackfin devices.
 */</span>
<span class="kw1">package</span> adi.targets.rtsblackfin <span class="br0">&#123;</span><span class="br0">&#125;</span></pre></td></tr></table>
<p><span id="AnchorPackageBuild">
</p>
<a name="package.bld"></a><h3> <span class="mw-headline">package.bld</span></h3>
<p></span>
The build script below builds the <tt>xdc.runtime</tt> modules in the package containing this script.  This allows you to build and release support for new targets without ever having to modify the <tt>xdc.runtime</tt> package itself!
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="coMULTI">/* get build support from the xdc.runtime package itself */</span>
<span class="kw1">var</span> RtsBuild = <span class="re1">xdc.loadCapsule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc/runtime/build.xs&quot;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="coMULTI">/* add makefile content from xdc.runtime to this package */</span>
Pkg.makePrologue = RtsBuild.makePrologue; 
&nbsp;
<span class="coMULTI">/* build libraries for all targets that support the &quot;blackfin&quot; ISA */</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> i = <span class="nu0">0</span>; i &lt; Build.targets.length; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> targ = Build.targets<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
    <span class="kw1">if</span> <span class="br0">&#40;</span>targ.isa == <span class="st0">&quot;blackfin&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        Pkg.addLibrary<span class="br0">&#40;</span><span class="st0">&quot;lib/&quot;</span> + Pkg.name, targ<span class="br0">&#41;</span>.addObjects<span class="br0">&#40;</span>RtsBuild.objs<span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></td></tr></table>
<p>If the build of the package succeeded, you've completed the first test of your new target.  To ensure that clients can use your target to create executables you should also build and run some simple client applications.  This is described in the next section.
</p>
<a name="Testing_Your_New_Target"></a><h3> <span class="mw-headline">Testing Your New Target </span></h3>
<p>To test your port of the <tt>xdc.runtime</tt> package you should be able build and run the examples referenced in the <a href="../Overview_of_xdc.runtime/Overview_of_xdc.runtime.html" title="Overview of xdc.runtime">Overview of <tt>xdc.runtime</tt></a>.  Since <a href="../Overview_of_xdc.runtime/Overview_of_xdc.runtime__Example_2.html" title="Overview of xdc.runtime/Example 2"> Example 2</a> minimizes external dependencies, starting with this example will allow you to focus on issues related to your target.
</p>
<a name="Removing_xdc.runtime_From_an_Application"></a><h2> <span class="mw-headline">Removing <tt>xdc.runtime</tt> From an Application</span></h2>
<p>Because the initialization of modules is controlled by the <tt>xdc.runtime.Startup</tt> module and most modules - even those without startup initialization requirements - rely on at least one of the <tt>xdc.runtime</tt> modules (e.g.,  <tt><a href="../../cdoc/xdc/runtime/Memory.html" class="cdoc"><tt>xdc.runtime.Memory</tt></a></tt>), the <tt>XDCtools</tt> implicitly import a package containing a pre-compiled version of the <tt>xdc.runtime</tt> modules.  However, there are times when you may need to create an application that does <i>not</i> include any of the <tt>xdc.runtime</tt> code or when you need to specify a specific package of pre-compiled <tt>xdc.runtime</tt> modules. 
</p><p>Each RTSC <a href="../Glossary/Glossary.html#TargetDefinition" title="Glossary">target</a> names a package containing pre-compiled versions of the <tt>xdc.runtime</tt> modules (see <a href="../../cdoc/xdc/bld/ITarget.html#rts" class="cdoc"><tt>xdc.bld.ITargets.rts</tt></a>) and, by default, this package will be imported into your application's configuration.  However, you can disable this implicit import by setting the <tt><a href="../../cdoc/index.html#xdc/bld/PackageContents.html#/.Attrs" class="cdoc"><tt>rtsName</tt></a></tt> attribute of the <tt><a href="../../cdoc/index.html#xdc/bld/Executable.html" class="cdoc"><tt>xdc.bld.Executable</tt></a></tt> instance created for your application to <tt>null</tt>.
</p><p>If you use the RTSC Build Engine to create your application, your <tt>package.bld</tt> build script will include a statement similar to the following:
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> exe = Pkg.addExecutable<span class="br0">&#40;</span><span class="st0">&quot;myApp&quot;</span>, target, target.platform, <span class="br0">&#123;</span>rtsName: <span class="kw2">null</span><span class="br0">&#125;</span><span class="br0">&#41;</span>;</pre></td></tr></table>
<p>If you use the <tt>xdc.tools.configuro</tt> tool, your command line should include the <tt>-rtsName</tt> option to disable the inclusion of the target's package of pre-compiled <tt>xdc.runtime</tt> modules (or to specify an alternative package).
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% xs xdc.tools.configuro ... -rtsName=&quot;&quot; myApp.cfg</span></b></pre></td></tr></table> 
<p><span id="AnchorUsingCustomBuild">
</p>
<a name="Using_a_Customized_Build_of_xdc.runtime"></a><h2> <span class="mw-headline">Using a Customized Build of <tt>xdc.runtime</tt></span></h2>
<p></span>
Each RTSC <a href="../Glossary/Glossary.html#TargetDefinition" title="Glossary">target</a> names a package containing pre-compiled versions of the <tt>xdc.runtime</tt> modules (see <a href="../../cdoc/xdc/bld/ITarget.html#rts" class="cdoc"><tt>xdc.bld.ITargets.rts</tt></a>) and, by default, this package will be imported into your application's configuration.  However, you can override this implicit import by setting the <tt><a href="../../cdoc/index.html#xdc/bld/PackageContents.html#/.Attrs" class="cdoc"><tt>rtsName</tt></a></tt> attribute of the <tt><a href="../../cdoc/index.html#xdc/bld/Executable.html" class="cdoc"><tt>xdc.bld.Executable</tt></a></tt> instance created for your application to the name of any package that supplies pre-built versions of the <tt>xdc.runtime</tt> modules.  You may want to do this to use different compiler optimization flags or use a more recent version of a compiler than that used by the package named by the target. 
</p><p>If you use the RTSC Build Engine to create your application, your <tt>package.bld</tt> build script will include a statement similar to the following:
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> exe = Pkg.addExecutable<span class="br0">&#40;</span><span class="st0">&quot;myApp&quot;</span>, target, target.platform, <span class="br0">&#123;</span>rtsName: <span class="st0">&quot;my.local.runtime&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>;</pre></td></tr></table>
<p>If you use the <tt>xdc.tools.configuro</tt> tool, your command line should include the <tt>-rtsName</tt> option to specify the package of pre-compiled <tt>xdc.runtime</tt> modules to use in lieu of the one named by the target.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br /></tt></td><td class="codexBody"><pre><b><span class="st0">% xs xdc.tools.configuro ... -rtsName=&quot;my.local.runtime&quot; myApp.cfg</span></b></pre></td></tr></table>
<a name="Using_xdc.runtime_Within_C-Only_Environments"></a><h2> <span class="mw-headline">Using <tt>xdc.runtime</tt> Within C-Only Environments</span></h2>
<p>The <tt>xdc.runtime</tt> package contains a single C++ file that is used to portably initialize all modules in a system by calling <tt><a href="../../cdoc/xdc/runtime/Startup.html#exec" class="cdoc"><tt>Startup_exec()</tt></a></tt> as part of a static C++ initializer.  However, there are execution environments where C++ is not supported; e.g., some micro-controllers are only supported by a C compiler, and some kernel-level execution environments don't support C++ initializers.  In these cases, it is necessary to 
</p>
<ol><li>rebuild all of the <tt>xdc.runtime</tt> C sources <i>without</i> this one C++ file,
</li><li>configure your system to use this new variant of the runtime, and 
</li><li>"manually" call <tt>Startup_exec()</tt> prior to using any <tt>xdc.runtime</tt> services.
</li></ol>
<p><img src="../common/extensions/rtsc/images/tip.png" />  If your target supports C++ <i>and</i> there is an existing runtime support library package for your target, you can skip the the first two steps above by simply defining a C function named <tt>__xdc__init()</tt> in the same file that calls <tt>Startup_exec()</tt>.  The <tt>__xdc__init()</tt> symbol is referenced in all generated configuration files (to force the initialization of a C++ variable that in turn causes <tt>Startup_exec()</tt> to run).  By defining this symbol in a file that is always linked ahead of any library, you can effectively "short-circuit" the C++ initializer defined in the <tt>xdc.runtime</tt> sources.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="c"><span class="re1">#include</span> <span class="re2">&lt;xdc/runtime/Startup.h&gt;</span>
&nbsp;
<span class="kw2">int</span> __xdc__init<span class="br0">&#40;</span>void<span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="kw1">return</span> <span class="nu0">0</span>;<span class="br0">&#125;</span>
&nbsp;
<span class="kw2">int</span> main<span class="br0">&#40;</span><span class="kw2">int</span> argc, <span class="kw2">char</span> *argv<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
   Startup_exec<span class="br0">&#40;</span><span class="br0">&#41;</span>;
      &nbsp;:
<span class="br0">&#125;</span></pre></td></tr></table>
<p><span id="AnchorPackageBuildCOnly">
</p>
<a name="Rebuilding_Just_the_C_Sources"></a><h4> <span class="mw-headline">Rebuilding Just the C Sources</span></h4>
<p></span>
To rebuild the <tt>xdc.runtime</tt> so that it does not include <i>any</i> C++ files, you can use a <tt>package.bld</tt> similar to the one shown below.  The only difference between this file and the one shown in the section "<a href="#AnchorPortingToNewTarget" title="">Porting to a New Target</a>" is that rather than using the <tt>RtsBuild.objs</tt> list of files, the <tt>package.bld</tt> below uses <tt>RtsBuild.c_objs</tt> (a list that includes all <tt>xdc.runtime</tt> sources <i>except</i> for the C++ initialization file).
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr><td class="codexLab"></td><td class="codexName"><tt>package.bld</tt></td></tr><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="coMULTI">/*
 *  This build script builds xdc.runtime modules in the current package
 */</span>
&nbsp;
<span class="coMULTI">/* get build support from the xdc.runtime package itself */</span>
<span class="kw1">var</span> RtsBuild = <span class="re1">xdc.loadCapsule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc/runtime/build.xs&quot;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="coMULTI">/* add makefile content from xdc.runtime to this package */</span>
Pkg.makePrologue = RtsBuild.makePrologue; 
&nbsp;
<span class="coMULTI">/* build libraries for all targets that support the &quot;blackfin&quot; ISA */</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> i = <span class="nu0">0</span>; i &lt; Build.targets.length; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> targ = Build.targets<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
    <span class="kw1">if</span> <span class="br0">&#40;</span>targ.isa == <span class="st0">&quot;blackfin&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="coMULTI">/* add only C files: this requires all users to explicitly call Startup_exec() */</span>
        Pkg.addLibrary<span class="br0">&#40;</span><span class="st0">&quot;lib/&quot;</span> + Pkg.name, targ<span class="br0">&#41;</span>.addObjects<span class="br0">&#40;</span>RtsBuild.c_objs<span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></td></tr></table>
<a name="Use_This_New_Build_of_xdc.runtime"></a><h3> <span class="mw-headline">Use This New Build of <tt>xdc.runtime</tt></span></h3>
<p>To use this custom build of the <tt>xdc.runtime</tt>, we follow the same proceedure outlined in the section "<a href="#AnchorUsingCustomBuild" title="">Using a Customized Build of <tt>xdc.runtime</tt></a>"; i.e., either use the <a href="../../cdoc/xdc/bld/Executable.html#/.Attrs" class="cdoc"><tt>rtsName</tt></a> attribute of executables when using <tt>package.bld</tt> scripts or use the <tt>-rtsName</tt> command line option when using <tt><a href="../../cdoc/index.html#xdc/tools/configuro/Main.html" class="cdoc"><tt>xdc.tools.configuro</tt></a></tt> directly.
</p>
<a name="Manually_Initializing_All_RTSC_Modules"></a><h3> <span class="mw-headline">Manually Initializing All RTSC Modules</span></h3>
<p>Before using any RTSC module, including any module in the <tt>xdc.runtime</tt> package, it must first be initialized.  The initialization of all RTSC modules is normally handled automatically, but if you are using a variant of <tt>xdc.runtime</tt> that does not include any C++ initializers you must explicitly call <tt><a href="../../cdoc/xdc/runtime/Startup.html#exec" class="cdoc"><tt>Startup_exec()</tt></a></tt> before the first use of <i>any</i> RTSC module.  Normally this simply means calling <tt>Startup_exec()</tt> in main().
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="c"><span class="re1">#include</span> <span class="re2">&lt;xdc/runtime/Startup.h&gt;</span>
&nbsp;
<span class="kw2">int</span> main<span class="br0">&#40;</span><span class="kw2">int</span> argc, <span class="kw2">char</span> *argv<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
   Startup_exec<span class="br0">&#40;</span><span class="br0">&#41;</span>;
      &nbsp;:
<span class="br0">&#125;</span></pre></td></tr></table>
<table width="100%"><tr><td class="lights"><img src="../common/extensions/rtsc/images/yellow_light.png" /></td><td class="offline">[<a href="/mediawiki-tip/index.php?title=Working with xdc.runtime&amp;printable=yes" title="just this page in black-and-white, ready for printing in landscape orientation">printable version</a>]&nbsp;&nbsp;[<a href="/mediawiki-tip/index.php?title=Special:Offline/Working with xdc.runtime" title="a standalone HTML bundle of this entire document, ready for download">offline version</a>]</td><td class="offlineDate">offline version generated on 02-Oct-2009 22:10 UTC</td><td class="arrows"><a href="../XDCtools_User's_Guide/XDCtools_User's_Guide.html" title="XDCtools User's Guide"><img src="../common/extensions/rtsc/images/Arrow_up.png" /></a></td></tr></table><div id=copyInfo>Copyright &#169; 2008 The Eclipse Foundation. All Rights Reserved</div>
<!-- 
Pre-expand include size: 3132 bytes
Post-expand include size: 1863 bytes
Template argument size: 259 bytes
Maximum: 2097152 bytes
-->

			<div class="printfooter">
Retrieved from "<a href="http://rtsc.eclipse.org/docs-tip/Special:Offline">http://rtsc.eclipse.org/docs-tip/Special:Offline</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
					 <li id="ca-nstab-special" class="selected"><a href="../Special:Offline/Special:Offline__Working_with_xdc.runtime.html" title="This is a special page, you can't edit the page itself">Special</a></li>
				</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="mediawiki-tip/index.php?title=Special:Userlogin&amp;returnto=Special:Offline" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../common/extensions/rtsc/images/logo.png);" href="/docs-tip/Main_Page" title="Visit the Main Page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-RTSC-pedia-home"><a href="../Main_Page/Main_Page.html">RTSC-pedia home</a></li>
				<li id="n-RTSC-project-home"><a href="http://rtsc.eclipse.org ">RTSC project home</a></li>
				<li id="n-News-.26-support"><a href="http://www.eclipse.org/newsportal/thread.php?group=eclipse.dsdp.rtsc">News &amp; support</a></li>
				<li id="n-Help"><a href="../Help:Contents/Help:Contents.html">Help</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-binders'>
		<h5>binders</h5>
		<div class='pBody'>
			<ul>
				<li id="n-General-Information"><a href="../General_Information/General_Information.html">General Information</a></li>
				<li id="n-RTSC-Programming"><a href="../RTSC_Programming/RTSC_Programming.html">RTSC Programming</a></li>
				<li id="n-User.27s-Guide"><a href="../XDCtools_User%27s_Guide/XDCtools_User%27s_Guide.html">User's Guide</a></li>
				<li id="n-Reference-Manual"><a href="../XDCtools_Reference_Manual/XDCtools_Reference_Manual.html">Reference Manual</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-package_reference'>
		<h5>package reference</h5>
		<div class='pBody'>
			<ul>
				<li id="n-XDCtools-packages"><a href="http://rtsc.eclipse.org/cdoc-tip/index.html ">XDCtools packages</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-lists'>
		<h5>lists</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Master-doc-map"><a href="../Special:DocMap/Special:DocMap__Main_Page.html">Master doc-map</a></li>
				<li id="n-Category-query"><a href="../Special:Cats/Special:Cats.html">Category query</a></li>
				<li id="n-Redirected-pages"><a href="../Special:Listredirects/Special:Listredirects.html">Redirected pages</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-tools'>
		<h5>tools</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Find.2BReplace-.28grep.29"><a href="../Special:Grep/Special:Grep.html">Find+Replace (grep)</a></li>
				<li id="n-RSS-feed"><a href="http://rtsc.eclipse.orgmediawiki-tip/index.php?title=Special:Recentchanges&amp;feed=rss ">RSS feed</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/docs-tip/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search RTSC-Pedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>more tools</h5>
		<div class="pBody">
			<ul>
<li id="t-upload"><a href="../Special:Upload/Special:Upload.html" title="Upload images or media files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="../Special:Specialpages/Special:Specialpages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../common/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="privacy"><a href="../RTSC-Pedia:Privacy_policy/RTSC-Pedia:Privacy_policy.html" title="RTSC-Pedia:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="../RTSC-Pedia:About/RTSC-Pedia:About.html" title="RTSC-Pedia:About">About RTSC-Pedia</a></li>
				<li id="disclaimer"><a href="../RTSC-Pedia:General_disclaimer/RTSC-Pedia:General_disclaimer.html" title="RTSC-Pedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served in 0.209 secs. --></body></html>
