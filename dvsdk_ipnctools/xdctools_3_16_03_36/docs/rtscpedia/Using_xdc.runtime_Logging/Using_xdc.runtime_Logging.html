<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
				<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="mediawiki-tip/opensearch_desc.php" title="RTSC-Pedia (English)" />
		<title>Using xdc.runtime Logging - Offline Version</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "../common/skins/common/shared.css";
			@import "../common/skins/monobook/main.css";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../common/skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "../common/skins/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "../common/skins/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "../common/skins/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "../common/skins/monobook/IE70Fixes.css";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="../common/skins/common/IEFixes.js?97"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "../common/skins";
var wgArticlePath = "/docs-tip/$1";
var wgScriptPath = "mediawiki-tip";
var wgScript = "mediawiki-tip/index.php";
var wgServer = "http://rtsc.eclipse.org";
var wgCanonicalNamespace = "Special";
var wgCanonicalSpecialPageName = "Offline";
var wgNamespaceNumber = -1;
var wgPageName = "Special:Offline";
var wgTitle = "Offline";
var wgAction = "view";
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
var wgArticleId = 0;
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = 0;
/*]]>*/</script>
                
		<script type="text/javascript" src="../common/skins/common/wikibits.js?97"><!-- wikibits js --></script>
		<script type="text/javascript" src="mediawiki-tip/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "mediawiki-tip/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "mediawiki-tip/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "mediawiki-tip/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>
		<!-- Head Scripts -->
<link rel="stylesheet" type="text/css" href="../common/extensions/rtsc/ViewStyle.css" /><link rel="stylesheet" type="text/css" href="../common/extensions/rtsc/MainStyle.css" />
	</head>
<body  class="mediawiki ns--1 ltr page-Special_Offline">
	<div id="globalWrapper" align="center">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading"></h1>
		<div id="bodyContent">
			<h3 id="siteSub">From RTSC-Pedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content --><div id="revInfo">revision tip</div><span id="printInfo">&#151;&#151;&nbsp;LANDSCAPE orientation</span><table width="100%"><tr><td class="lights"><img src="../common/extensions/rtsc/images/yellow_light.png" /></td><td class="offline">[<a href="/mediawiki-tip/index.php?title=Using xdc.runtime Logging&amp;printable=yes" title="just this page in black-and-white, ready for printing in landscape orientation">printable version</a>]&nbsp;&nbsp;[<a href="/mediawiki-tip/index.php?title=Special:Offline/Using xdc.runtime Logging" title="a standalone HTML bundle of this entire document, ready for download">offline version</a>]</td><td class="offlineDate">offline version generated on 02-Oct-2009 22:10 UTC</td><td class="arrows"><a href="../Overview_of_xdc.runtime/Overview_of_xdc.runtime.html#Using_This_Package" title="Overview_of_xdc.runtime#Using_This_Package"><img src="../common/extensions/rtsc/images/Arrow_up.png" /></a>&nbsp;<a href="Using_xdc.runtime_Logging__Example_1.html" title="Example 1"><img src="../common/extensions/rtsc/images/Arrow_right.png" /></a></td></tr></table><p id="title">Using xdc.runtime Logging</p><p id="subtitle">How to generate and control Log events</p>
<p></p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1"><a href="#Overview"><span class="tocnumber">2</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2"><a href="#Architecture"><span class="tocnumber">2.1</span> <span class="toctext">Architecture</span></a></li>
<li class="toclevel-2"><a href="#Configuration"><span class="tocnumber">2.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1"><a href="#Built-in_Loggers"><span class="tocnumber">4</span> <span class="toctext">Built-in Loggers</span></a>
<ul>
<li class="toclevel-2"><a href="#LoggerBuf_Module"><span class="tocnumber">4.1</span> <span class="toctext">LoggerBuf Module</span></a>
<ul>
<li class="toclevel-3"><a href="#Configuration_example"><span class="tocnumber">4.1.1</span> <span class="toctext">Configuration example</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#LoggerSys_Module"><span class="tocnumber">4.2</span> <span class="toctext">LoggerSys Module</span></a>
<ul>
<li class="toclevel-3"><a href="#Configuration_example_2"><span class="tocnumber">4.2.1</span> <span class="toctext">Configuration example</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#Performance_Considerations"><span class="tocnumber">5</span> <span class="toctext">Performance Considerations</span></a>
<ul>
<li class="toclevel-2"><a href="#Execution_Time"><span class="tocnumber">5.1</span> <span class="toctext">Execution Time</span></a></li>
<li class="toclevel-2"><a href="#Code_Space"><span class="tocnumber">5.2</span> <span class="toctext">Code Space</span></a></li>
<li class="toclevel-2"><a href="#Data_Space"><span class="tocnumber">5.3</span> <span class="toctext">Data Space</span></a></li>
<li class="toclevel-2"><a href="#Configuration_Options"><span class="tocnumber">5.4</span> <span class="toctext">Configuration Options</span></a>
<ul>
<li class="toclevel-3"><a href="#Making_Log_print.28.29_or_Log_write.28.29_deterministic"><span class="tocnumber">5.4.1</span> <span class="toctext">Making Log_print() or Log_write() deterministic</span></a></li>
<li class="toclevel-3"><a href="#Eliminating_unnecessary_strings"><span class="tocnumber">5.4.2</span> <span class="toctext">Eliminating unnecessary strings</span></a></li>
<li class="toclevel-3"><a href="#Eliminating_per-instance_and_per-module_space_overhead"><span class="tocnumber">5.4.3</span> <span class="toctext">Eliminating per-instance and per-module space overhead</span></a></li>
<li class="toclevel-3"><a href="#Eliminating_runtime_event_control_code"><span class="tocnumber">5.4.4</span> <span class="toctext">Eliminating runtime event control code</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Introduction"></a><h2> <span class="mw-headline">Introduction</span></h2>
<p>The <tt>xdc.runtime</tt> package contains several modules that work together to provide rich application diagnostic support that can be controlled in real-time within deployed systems.  This section focuses on those modules that are used to generate "events", enable/disable their generation, and display the events: <tt><a href="../../cdoc/xdc/runtime/Log.html" class="cdoc"><tt>Log</tt></a></tt>, <tt><a href="../../cdoc/index.html#xdc/runtime/Diags.html" class="cdoc"><tt>Diags</tt></a></tt>, and <tt><a href="../../cdoc/index.html#xdc/runtime/LoggerSys.html" class="cdoc"><tt>LoggerSys</tt></a></tt>, respectively.  
</p><p>Use of these modules is illustrated below by a series of examples that take advantage of two other distinguished <tt>xdc.runtime</tt> modules:
</p>
<ol><li><tt><a href="../../cdoc/xdc/runtime/Main.html" class="cdoc"><tt>Main</tt></a></tt> - a module whose configuration applies to all code that is <i>not</i> a RTSC module; e.g., existing C code bases, and
</li><li><tt><a href="../../cdoc/xdc/runtime/Defaults.html" class="cdoc"><tt>Defaults</tt></a></tt> - a module whose configuration applies to all RTSC modules (including <tt>Main</tt>), unless explicitly overridden on a per-module basis.
</li></ol>
<a name="Overview"></a><h2> <span class="mw-headline">Overview</span></h2>
<p>The <tt>xdc.runtime</tt> package's logging support enables developers to embed "printf-like" <tt>Log</tt> statements virtually <i>anywhere</i> in an embedded real-time code base.  In addition to the traditional <tt>printf()</tt> format string and arguments, each <tt>Log</tt> statement is associated with a calling module and an "event mask" - a bit mask that identifies the "type" of statement.  The <tt>Log</tt> statements 
</p>
<ul><li>provide all the functionality of a "normal" printf, 
</li><li>can be enabled or disabled at runtime on a per-module and per-type basis, and
</li><li>have fixed low execution time independent of the arguments passed.
</li></ul>
<p>Applications can be configured to eliminate the data space required for the format strings, permanently disable (or enable) selected statements, eliminate the code space required for runtime control, and provide application-specific handling of the "events" produced by these statements.  All of these configuration options are possible <i>without requiring re-compilation of any source code</i>.
</p>
<a name="Architecture"></a><h3> <span class="mw-headline">Architecture</span></h3>
<p>For the purpose of logging, <i>every line</i> of code in an application is treated as being part of some RTSC module.  Any code that is not part of a RTSC module is considered to be part of the distinguished <tt><a href="../../cdoc/xdc/runtime/Main.html" class="cdoc"><tt>xdc.runtime.Main</tt></a></tt> module.
</p><p>All RTSC target modules have a 
</p>
<ul><li>current "event mask" - a set of event "types" that are enabled for the module,
</li><li>an optional <tt><a href="../../cdoc/xdc/runtime/ILogger.html" class="cdoc"><tt>ILogger</tt></a></tt> service provider - a module that handles events generated by the module, and
</li><li>an optional string name used to display the source of events
</li></ul>
<p>The <tt><a href="../../cdoc/xdc/runtime/Log.html#print6" class="cdoc"><tt>Log_print</tt></a></tt> or <tt><a href="../../cdoc/index.html#xdc/runtime/Log.html#write8" class="cdoc"><tt>Log_write</tt></a></tt> methods are used to generate or log "events".  These methods are simply in-line macros that conditionally invoke the calling module's underlying <tt>ILogger</tt> service provider to "handle" the events.  This service provider is called only if:
</p>
<ol><li>the module has a non-null <tt>ILogger</tt> service provider, and
</li><li>the mask argument passed to <tt>Log_print</tt> (or <tt>Log_write</tt>) anded with the calling module's current "event mask" is non-zero
</li></ol>
<p>The initial value of a module's event mask is specified during configuration and may be changed at runtime via <tt><a href="../../cdoc/xdc/runtime/Diags.html#set.Mask" class="cdoc"><tt>Diags_setMask()</tt></a></tt>.
</p><p>Beyond the parameters passed to <tt>Log_print</tt> (or <tt>Log_write</tt>), each event contains the name of the module that called <tt>Log_print</tt> (or <tt>Log_write</tt>) and space for an optional timestamp.  This additional information makes it possible for <tt>ILogger</tt> service providers to know the source of events and embed timestamps making it possible to correlate events from multiple sources (even from different CPUs).
</p><p>Two <tt>ILogger</tt> service providers are included in the xdc.runtime package: 
</p>
<ol><li><a href="../../cdoc/xdc/runtime/LoggerBuf.html" class="cdoc"><tt>LoggerBuf</tt></a> - copies events to a circular buffer in a fixed small number of cycles and is suitable for real-time high-frequency event sources, and
</li><li><a href="../../cdoc/xdc/runtime/LoggerSys.html" class="cdoc"><tt>LoggerSys</tt></a> - outputs events as they occur using <tt><a href="../../cdoc/index.html#xdc/runtime/System.html#printf" class="cdoc"><tt>System_printf()</tt></a></tt> and is suitable for initial development or low-rate non-real-time event sources.
</li></ol>
<p>Custom <tt>ILogger</tt> service providers can easily be created to address platform or application specific needs.  These custom providers can, of course, filter events and call <tt>LoggerBuf</tt> or <tt>LoggerSys</tt>.  For information about creating and deploying a custom logger see <a href="../Extending_xdc.runtime_Logging/Extending_xdc.runtime_Logging.html" title="Extending xdc.runtime Logging">Extending xdc.runtime Logging</a>.
</p><p>As part of an application's configuration step, developers "bind" zero or more <tt>ILogger</tt> service providers to the modules that comprise the application.  Each module in a system can have a different <tt>ILogger</tt> service provider or they can all share the same provider.  Events generated by modules <i>without</i> an <tt>ILogger</tt> service provider are silently ignored.
</p>
<a name="Configuration"></a><h3> <span class="mw-headline">Configuration</span></h3>
<p>Users of libraries that embed <tt>xdc.runtime.Log</tt> statements can configure their application to specify:
</p>
<ul><li>what modules should be "traceable" and whether their <tt>Log</tt> events are controllable at runtime or only at configuration time
</li><li>on a per-module basis, what <tt>ILogger</tt> service providers should be used to "handle" the events as they are generated
</li><li>for the <tt>ILogger</tt> service providers <tt><a href="../../cdoc/xdc/runtime/LoggerBuf.html" class="cdoc"><tt>LoggerBuf</tt></a></tt> and <tt><a href="../../cdoc/index.html#xdc/runtime/LoggerSys.html" class="cdoc"><tt>LoggerSys</tt></a></tt>, what <tt>ITimestampProvider</tt> service module to use to timestamp individual events
</li></ul>
<p>The ability to configure a unique <tt>ILogger</tt> service provider for each module in an application together with the <tt>xdc.runtime.Main</tt> module representing all other code, enables the integrator to separately manage events from all parts of the code base independent of who produced the code.  
</p><p>Since the computation of timestamps is highly platform-specific and the required precision of timestamps is application dependent, the <tt>ILogger</tt> service providers in the <tt>xdc.runtime</tt> package can be configured with an appropriate timestamp service provider. 
</p><p>These configuration options make it possible for the system integrator to strike a balance between the need for application runtime visibility against the overhead required for this visibility <i>without making any changes</i> to the code containing embedded <tt>Log_print</tt> (or <tt>Log_write</tt>) statements.  Even better, these options are possible <i>without requiring re-compilation of any source code</i> making it possible to (re)configure pre-built <i>binary</i> libraries that utilize <tt>xdc.runtime.Log</tt> methods.
</p>
<a name="Examples"></a><h2> <span class="mw-headline">Examples</span></h2>
<p>The best way to understand how to use and take advantage of the logging facilities provided by the <tt>xdc.runtime</tt> package is to study some simple examples.  In the table below, we provide a series of graduated examples that illustrate the key capabilities of logging and provide links to more advanced topics.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tr>
<th align="center"> <b>Example</b>
</th><th align="center"> <b>Description</b>
</th><th align="center"> <b>Purpose</b>
</th></tr>
<tr>
<td align="left"> <a href="Using_xdc.runtime_Logging__Example_1.html" title="Using xdc.runtime Logging/Example 1">Example&nbsp;1</a>
</td><td align="left"> Classic "hello world" using <tt>Log</tt>
</td><td align="left"> provide a gentle introduction to basic logging concepts
</td></tr>
<tr>
<td align="left"> <a href="Using_xdc.runtime_Logging__Example_2.html" title="Using xdc.runtime Logging/Example 2">Example 2</a>
</td><td align="left"> Events provided by all RTSC target modules
</td><td align="left"> show how users manage the <tt>Log</tt> events implicitly generated by RTSC modules
</td></tr>
<tr>
<td align="left"> <a href="Using_xdc.runtime_Logging__Example_3.html" title="Using xdc.runtime Logging/Example 3">Example 3</a>
</td><td align="left"> Adding logging to existing code bases
</td><td align="left"> show how to add logging by making <i>minimal</i> changes to existing code and how, with almost no extra effort, to provide the same logging "look and feel" as RTSC modules.
</td></tr>
<tr>
<td align="left"> <a href="Using_xdc.runtime_Logging__Example_4.html" title="Using xdc.runtime Logging/Example 4">Example 4</a>
</td><td align="left"> Adding logging to RTSC target modules
</td><td align="left"> show how to add logging to RTSC modules in such a way that users can view fully decoded events <i>without</i> any format strings on the embedded target
</td></tr></table>
<p>In addition to the "client-side" examples above, the table below lists examples of how to create <tt>ILogger</tt> modules that "handle" the events generated by clients.  The examples listed below illustrate how one can provide sophisticated application and platform specific capabilities and require a bit more experience with RTSC modules.  However, they are simple enough to be used and modified by relative novices.
</p>
<table cellpadding="4" cellspacing="2" border="1" style="color:black;background-color:#eeeeee;">

<tr>
<th align="center"> <b>Example</b>
</th><th align="center"> <b>Description</b>
</th><th align="center"> <b>Purpose</b>
</th></tr>
<tr>
<td align="left"> <a href="../Extending_xdc.runtime_Logging/Extending_xdc.runtime_Logging__Example_1.html" title="Extending xdc.runtime Logging/Example 1">Example 1</a>
</td><td align="left"> Creating a custom <tt>ILogger</tt>
</td><td align="left"> show how to create an <tt>ILogger</tt> to handle and optionally filter <tt>Log</tt> events
</td></tr></table>
<a name="Built-in_Loggers"></a><h2> <span class="mw-headline">Built-in Loggers</span></h2>
<p>The <tt>xdc.runtime</tt> package includes two built-in loggers:
</p>
<ol><li><tt><a href="../../cdoc/xdc/runtime/LoggerBuf.html" class="cdoc"><tt>LoggerBuf</tt></a></tt> - a logger that simply records events in a memory buffer, and
</li><li><tt><a href="../../cdoc/xdc/runtime/LoggerSys.html" class="cdoc"><tt>LoggerSys</tt></a></tt> - a logger that uses <tt>System_printf()</tt> to output events as they occur.
</li></ol>
<p>The following sections briefly describe these loggers and show examples of their use.  <a href="../Extending_xdc.runtime_Logging/Extending_xdc.runtime_Logging.html" title="Extending xdc.runtime Logging">Extending xdc.runtime Logging</a> describes how to create additional loggers. 
</p>
<a name="LoggerBuf_Module"></a><h3> <span class="mw-headline"><tt>LoggerBuf</tt> Module</span></h3>
<p>The <tt>xdc.runtime.LoggerBuf</tt> module provides a logger that stores run-time <tt>Log</tt> events in a buffer.
</p><p>This logger captures <tt>Log</tt> events in real-time to a buffer. The <tt>Log</tt> events stored in the buffer are unformatted; the log event formatting is deferred. Use <tt>LoggerBuf_flush()</tt> to process the <tt>Log</tt> events stored in the buffer and stream the formatted output to stdout.
</p><p>The implementation of this logger is fast with minimal stack usage making it appropriate for real-time applications. If this logger is used in a preemptive environment, then an appropriate gate must be assigned to the module. For example, if you wish to generate <tt>Log</tt> events from an interrupt context, then a gate that disables interrupts must be used.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> LoggerBuf = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st1">'xdc.runtime.LoggerBuf'</span><span class="br0">&#41;</span>;
LoggerBuf.common$.gate = ...some gate instance...</pre></td></tr></table>
<p>If the buffer type is circular, the log buffer contains the last <tt>LoggerBuf_numEntries</tt> events. If the <tt>bufType</tt> is fixed, the log buffer contains the first <tt>LoggerBuf_numEntries</tt> events since the buffer was cleared.
</p>
<a name="Configuration_example"></a><h6> <span class="mw-headline">Configuration example</span></h6>
<p><span class="Leader">Configuration example</span>.&nbsp;  The following configuration statements create a logger instance, assign it as the default logger for all modules, and enable
USER1 logging in all modules of the package my.pkg. See the <tt><a href="../../cdoc/xdc/runtime/Diags.html#set.Mask.Meta" class="cdoc"><tt>Diags.setMaskMeta()</tt></a></tt> reference documentation for details on specifying the module names.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> LoggerBuf = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st1">'xdc.runtime.LoggerBuf'</span><span class="br0">&#41;</span>;
LoggerBuf.enableFlush = <span class="kw2">true</span>;
&nbsp;
<span class="kw1">var</span> Defaults = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st1">'xdc.runtime.Defaults'</span><span class="br0">&#41;</span>;
Defaults.common$.logger = LoggerBuf.create<span class="br0">&#40;</span><span class="br0">&#123;</span>exitFlush: <span class="kw2">true</span><span class="br0">&#125;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">var</span> Diags = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st1">'xdc.runtime.Diags'</span><span class="br0">&#41;</span>;
Diags.setMaskMeta<span class="br0">&#40;</span><span class="st0">&quot;my.pkg.%&quot;</span>, Diags.USER1, Diags.RUNTIME_ON<span class="br0">&#41;</span>;</pre></td></tr></table>
<a name="LoggerSys_Module"></a><h3> <span class="mw-headline"><tt>LoggerSys</tt> Module</span></h3>
<p>The <tt>xdc.runtime.LoggerSys</tt> module routes events to the <tt>System_printf()</tt> function.
</p><p>This logger processes <tt>Log</tt> events as they are generated and routes them through the <tt>System_printf()</tt> function. The final disposition of the log event is dependent on which system provider has been assigned to <tt>System.SupportProxy</tt>.
</p><p>Note that the <tt>Log</tt> events are processed within the run-time context of the <tt>Log_write()</tt> or <tt>Log_print()</tt> function that generated the event. It is important to account for the processing overhead and stack usage imposed on the runtime context. The cost of this processing is defined by the implementation of the system provider.
</p>
<a name="Configuration_example_2"></a><h6> <span class="mw-headline">Configuration example</span></h6>
<p><span class="Leader">Configuration example</span>.&nbsp;  The following configuration statements create a logger instance, assign it as the default logger for all modules, and enable
USER1 logging in all modules of the package my.pkg. See the <tt><a href="../../cdoc/xdc/runtime/Diags.html#set.Mask.Meta" class="cdoc"><tt>Diags.setMaskMeta()</tt></a></tt> reference documentation for details on specifying the module names.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> LoggerSys = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.LoggerSys&quot;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">var</span> Defaults = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Defaults&quot;</span><span class="br0">&#41;</span>;
Defaults.common$.logger = LoggerSys.create<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">var</span> Diags = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Diags&quot;</span><span class="br0">&#41;</span>;
Diags.setMaskMeta<span class="br0">&#40;</span><span class="st0">&quot;my.pkg.%&quot;</span>, Diags.USER1, Diags.RUNTIME_ON<span class="br0">&#41;</span>;</pre></td></tr></table>
<a name="Performance_Considerations"></a><h2> <span class="mw-headline">Performance Considerations</span></h2>
<p>This section provides an overview of the performance overhead you can expect when using the <tt>xdc.runtime</tt> logging facilities.  Generally speaking, the configuration capabilities included allow developers to strike a balance between runtime visibility and overhead for even the most resource constrained systems.  Several common configuration options are described in the <a href="Using_xdc.runtime_Logging.html#Configuration_Options" title="Using xdc.runtime Logging">Configuration Options</a> section below.
</p>
<a name="Execution_Time"></a><h3> <span class="mw-headline">Execution Time</span></h3>
<p>Because <tt>Log_print</tt> and <tt>Log_write</tt> are inline macros, when events are disabled, the time overhead for these statements is quite low; typically only a few instruction cycles.  As a result, leaving these statements in deployed applications is quite practical.  When events are enabled, the time overhead is largely a function of the underlying module's <tt>ILogger</tt> service provider.  
</p><p>For providers like <tt>LoggerBuf</tt>, even this overhead is small enough to allow most applications to continue to meet their real-time deadlines even while simultaneously capturing logging events.  On the other hand, the <tt>LoggerSys</tt> provider does not simply record event data to a buffer, it "formats" each event as it occurs using <tt>System_printf()</tt>.  While useful during initial development, this processing can be somewhat expensive and should not be used with modules whose methods are time critical.
</p><p>Runtime control of event generation is supported via <tt>Diags_setmask()</tt>.  Since this method uses a string to "look up" module event masks, its execution time is a function of the number of modules in the system and the lengths of their names.  Although relatively efficient, this method should not be used in time sensitive legs of an application.
</p>
<a name="Code_Space"></a><h3> <span class="mw-headline">Code Space</span></h3>
<p>Code space overhead for logging support comes from three places:
</p>
<ol><li>the instructions required at each <tt>Log_print()</tt> / <tt>Log_write()</tt> call site (to test the current mask and conditionally generate a <tt>Log</tt> event)
</li><li>the <tt>xdc.runtime</tt> modules themselves, and 
</li><li>the underlying <tt>ILogger</tt> service provider
</li></ol>
<p>Although the code space overhead per <tt>Log_print()</tt> / <tt>Log_write()</tt> call site is only a few words, thousands of call sites can add up to a significant amount of code.  Since "entry", "exit" and "life-cycle" events are added during configuration for RTSC modules (and don't appear in the module's sources), the overhead for this support is 100% controllable by the system integrator via configuration options; on a per module basis, the end user can add or remove varying degrees of logging support.
</p><p>The code space required for the <tt>xdc.runtime</tt> library is relatively small (e.g., approximately 2K bytes for the C64) but, even if there are embedded references to the <tt>Log_print()</tt> / <tt>Log_write()</tt> functions, the runtime library code can be completely "configured out" of an application by the system integrator; i.e., <i>no recompilation of any sources is required</i>.
</p><p>Finally, the <tt>ILogger</tt> service provider's code size is a function of the module used to "handle" <tt>Log</tt> events. Although only <tt>LoggerBuf</tt> and <tt>LoggerSys</tt> are provided by <tt>xdc.runtime</tt> package, it is expected that customized <tt>ILogger</tt> service provider will be used to leverage platform-specific communication mechanisms.  A practical estimate of the code size overhead is the code size of the larger of the two supplied loggers, <tt>LoggerBuf</tt>, which is about 2K bytes on a C64 architecture.
</p>
<a name="Data_Space"></a><h3> <span class="mw-headline">Data Space</span></h3>
<p>Data space overhead for logging support comes from three places:
</p>
<ol><li>the format strings required at each <tt>Log_print()</tt> call site and the format strings in each <tt>Log_Event</tt>
</li><li>the data space for the module name lookup tables required to support <tt>Diags_setMask()</tt>, and
</li><li>one string pointer per "named" instance object to maintain a "human readable" name for these instances 
</li></ol>
<p>The format strings used for each event can add up to be relatively significant amount of space, especially on very small systems.  Using <tt>Log_write()</tt> in lieu of <tt>Log_print()</tt> allows these strings to be moved entirely off the target.  In addition, since RTSC modules do not need to add <tt>Log</tt> statements to provide "entry", "exit", or "lifecycle" events, the only significant overhead comes from explicit calls to <tt>Log_print()</tt>.  Judicious use of <tt>Log_print()</tt> should ensure that this overhead is acceptable for most applications.
</p><p>To support runtime control of <tt>Log</tt> events via <tt>Diags_setMask()</tt> a table of module names is created during configuration.  This table is relatively small (approximately two words per module plus a module name string).  For systems that do not need runtime control of events, it is possible to disable the generation of this table; see the Configuration Options section below.
</p><p>Finally, all RTSC modules optionally support the ability to associate a string name with instances.  While this can be beneficial for systems with a relatively small number of instances (hundreds), high density systems that need to support thousands of channels don't need (or want) a distinct string name for each instance, for example.  Each RTSC module can be separately configured to reserve space for instance names (or not).
</p>
<a name="Configuration_Options"></a><h3> <span class="mw-headline">Configuration Options</span></h3>
<p>The <tt>xdc.runtime</tt> logging support offers a variety of configuration options to satisfy the often conflicting performance requirements of different embedded applications.  This section summarizes some of these options.
</p>
<ul><li>every module <i>can</i> have a different <tt>ILogger</tt> service provider
</li><li>every RTSC instance object <i>can</i> have a "human readable" string name
</li><li>runtime control via <tt>Diags_setMask()</tt> can be "configured out" of an application
</li><li>event format strings do not need to be stored in the application
</li></ul>
<a name="Making_Log_print.28.29_or_Log_write.28.29_deterministic"></a><h6> <span class="mw-headline">Making <tt>Log_print()</tt> or <tt>Log_write()</tt> deterministic</span></h6>
<p><span class="Leader">Making <tt>Log_print()</tt> or <tt>Log_write()</tt> deterministic</span>.&nbsp;When an event is generated by either <tt>Log_print()</tt> or <tt>Log_write()</tt>, the execution time overhead is purely a function of the underlying <tt>ILogger</tt> serive provider.  So, to get deterministic low overhead execution times, you must use an appropriate service provider:  you can use <tt><a href="../../cdoc/xdc/runtime/LoggerBuf.html" class="cdoc"><tt>LoggerBuf</tt></a></tt> or, of course, write your own <tt>ILogger</tt> service provider.  You must then configure the modules in you application to use this logger.  The following configuration script fragment sets <tt>LoggerBuf</tt> to be the default logger for all modules.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> Defaults = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Defaults&quot;</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> Logger = <span class="re1">xdc.useModule</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.LoggerBuf&quot;</span><span class="br0">&#41;</span>;
Defaults.common$.logger = Logger.create<span class="br0">&#40;</span><span class="br0">&#41;</span>;</pre></td></tr></table>
<a name="Eliminating_unnecessary_strings"></a><h6> <span class="mw-headline">Eliminating unnecessary strings</span></h6>
<p><span class="Leader">Eliminating unnecessary strings</span>.&nbsp;  Adding "printf-like" statements to a C code base not only increases code space (the instructions to put arguments in registers and call a function) but it can significantly increase an application's data space requirements; each "printf-like" format string is added to a data section reserved for constants and the size of section can grow quickly as more and more logging statements are added.  While it's not possible to stop the strings used in <tt>Log_print()</tt> statements from taking up space in the target, it <i>is</i> possible to <i>completely</i> eliminate the format strings by used by <tt>Log_write()</tt>.
</p><p>In lieu of a mask and a format string as initial arguments, <tt>Log_write()</tt> takes a <tt>Log_Event</tt>.  A <tt>Log_Event</tt> is an opaque reference to a structure that contains a mask <i>and</i> a format string.  How does this help?  By eliminating direct references to literal strings in the C sources, the C compiler only sees an integer index being passed to <tt>Log_write()</tt> and never needs to allocate space for the constant format string.  During configuration, it's possible to generate a table of all <tt>Log_Event</tt> format strings, define <tt>Log_Event</tt> as an index into this table, and arrange for this table to loaded in a separate output section.  Since this table is only needed when the event is "decoded", the table (with the strings) does not need to be loaded into the target's memory; events can be decoded by host-based development tools which simply lookup the event based on the index supplied by <tt>Log_write()</tt>.  This table of strings is managed by the <a href="../../cdoc/xdc/runtime/Text.html" class="cdoc"><tt>xdc.runtime.Text</tt></a> module.
</p><p>To eliminate the runtime strings you must configure the <tt>Text</tt> module to place all strings in a special section that will not be loaded onto the target.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript"><span class="kw1">var</span> Text = <span class="re1">xdc.module</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Text&quot;</span><span class="br0">&#41;</span>;
Text.isLoaded = <span class="kw2">false</span>;</pre></td></tr></table>
<p>In addition to format strings used in <tt>Log_print()</tt> statements, string names of all modules and (optionally) instances are also maintained on the target.  Again, in systems where space is a precious resource, it is sometimes necessary to eliminate these "conveniences" in favor of other critical data.  The next section shows how to not only eliminate the strings but also the one-word per-instance and per-module overhead to hold a pointer to these strings.
</p>
<a name="Eliminating_per-instance_and_per-module_space_overhead"></a><h6> <span class="mw-headline">Eliminating per-instance and per-module space overhead</span></h6>
<p><span class="Leader">Eliminating per-instance and per-module space overhead</span>.&nbsp;  To facilitate deciphering an application's <tt>Log</tt> events, all RTSC modules can <i>optionally</i> reserve an extra word to hold a pointer to a string name for each instance.  Unless you specify otherwise, space required to hold a pointer to a name is <i>not</i> reserved in instance objects and, as a result, the "life-cycle" events do not provide the names of the instances that were specified in the application.  Make sure you have not inadvertently enabled instance names via the <a href="../../cdoc/xdc/runtime/Types.html#.Common$" class="cdoc"><tt>namedInstance</tt></a>  configuration parameter.
</p><p>On the other hand, all RTSC modules <i>do</i> have a string name that is part of the target runtime (by default).  You can eliminate these names for all modules, except for <tt><a href="../../cdoc/xdc/runtime/Memory.html" class="cdoc"><tt>Memory</tt></a></tt> and <tt><a href="../../cdoc/index.html#xdc/runtime/Main.html" class="cdoc"><tt>Main</tt></a></tt>, by setting the 
and <a href="../../cdoc/xdc/runtime/Types.html#.Common$" class="cdoc"><tt>namedModule</tt></a> configuration parameter to <tt>false</tt>.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript">   <span class="kw1">var</span> Defaults = <span class="re1">xdc.module</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Defaults&quot;</span><span class="br0">&#41;</span>;
   Defaults.common$.namedModule = <span class="kw2">false</span>;</pre></td></tr></table>
<p>Since the overhead of two module names is quite small and both <tt>Memory</tt> and <tt>Main</tt> are referenced in many <tt>Error</tt> events, to eliminate the names for <tt>Main</tt> and <tt>Memory</tt> you must explicitly set their <tt>common$.namedModule</tt> configuration parameter to <tt>false</tt>.
</p>
<table cellpadding="0" cellspacing="0" class="codex"><tr class="codex"><td class="codexLab"><tt class="codexLab">&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br /></tt></td><td class="codexBody"><pre class="xdcscript">   <span class="kw1">var</span> Main = <span class="re1">xdc.module</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Main&quot;</span><span class="br0">&#41;</span>;
   Main.common$.namedModule = <span class="kw2">false</span>;
&nbsp;
   <span class="kw1">var</span> Memory = <span class="re1">xdc.module</span><span class="br0">&#40;</span><span class="st0">&quot;xdc.runtime.Memory&quot;</span><span class="br0">&#41;</span>;
   Memory.common$.namedModule = <span class="kw2">false</span>;</pre></td></tr></table>
<a name="Eliminating_runtime_event_control_code"></a><h6> <span class="mw-headline">Eliminating runtime event control code</span></h6>
<p><span class="Leader">Eliminating runtime event control code</span>.&nbsp;  The ability to control event masks at runtime is a common requirement but, in extremely resource constrained systems it may not be a luxury that can be afforded.  Eliminating this support is possible by setting the  <a href="../../cdoc/xdc/runtime/Diags.html#set.Mask.Enabled" class="cdoc"><tt>Diags.setMaskEnabled</tt></a> configuration parameter to <tt>false</tt>.
</p>
<p><div class="Notice"><p class="Notice">You must also <i>not</i> set any module's event types to <tt>Diags.RUNTIME_*</tt>; otherwise the <tt>setMaskEnabled</tt> will be implicitly reset to <tt>true</tt> and you will not see the code savings you expect.</p></div></p>
<table width="100%"><tr><td class="lights"><img src="../common/extensions/rtsc/images/yellow_light.png" /></td><td class="offline">[<a href="/mediawiki-tip/index.php?title=Using xdc.runtime Logging&amp;printable=yes" title="just this page in black-and-white, ready for printing in landscape orientation">printable version</a>]&nbsp;&nbsp;[<a href="/mediawiki-tip/index.php?title=Special:Offline/Using xdc.runtime Logging" title="a standalone HTML bundle of this entire document, ready for download">offline version</a>]</td><td class="offlineDate">offline version generated on 02-Oct-2009 22:10 UTC</td><td class="arrows"><a href="../Overview_of_xdc.runtime/Overview_of_xdc.runtime.html#Using_This_Package" title="Overview_of_xdc.runtime#Using_This_Package"><img src="../common/extensions/rtsc/images/Arrow_up.png" /></a>&nbsp;<a href="Using_xdc.runtime_Logging__Example_1.html" title="Example 1"><img src="../common/extensions/rtsc/images/Arrow_right.png" /></a></td></tr></table><div id=copyInfo>Copyright &#169; 2008 The Eclipse Foundation. All Rights Reserved</div>
<!-- 
Pre-expand include size: 3055 bytes
Post-expand include size: 2299 bytes
Template argument size: 600 bytes
Maximum: 2097152 bytes
-->

			<div class="printfooter">
Retrieved from "<a href="http://rtsc.eclipse.org/docs-tip/Special:Offline">http://rtsc.eclipse.org/docs-tip/Special:Offline</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
					 <li id="ca-nstab-special" class="selected"><a href="../Special:Offline/Special:Offline__Using_xdc.runtime_Logging.html" title="This is a special page, you can't edit the page itself">Special</a></li>
				</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="mediawiki-tip/index.php?title=Special:Userlogin&amp;returnto=Special:Offline" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../common/extensions/rtsc/images/logo.png);" href="/docs-tip/Main_Page" title="Visit the Main Page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-RTSC-pedia-home"><a href="../Main_Page/Main_Page.html">RTSC-pedia home</a></li>
				<li id="n-RTSC-project-home"><a href="http://rtsc.eclipse.org ">RTSC project home</a></li>
				<li id="n-News-.26-support"><a href="http://www.eclipse.org/newsportal/thread.php?group=eclipse.dsdp.rtsc">News &amp; support</a></li>
				<li id="n-Help"><a href="../Help:Contents/Help:Contents.html">Help</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-binders'>
		<h5>binders</h5>
		<div class='pBody'>
			<ul>
				<li id="n-General-Information"><a href="../General_Information/General_Information.html">General Information</a></li>
				<li id="n-RTSC-Programming"><a href="../RTSC_Programming/RTSC_Programming.html">RTSC Programming</a></li>
				<li id="n-User.27s-Guide"><a href="../XDCtools_User%27s_Guide/XDCtools_User%27s_Guide.html">User's Guide</a></li>
				<li id="n-Reference-Manual"><a href="../XDCtools_Reference_Manual/XDCtools_Reference_Manual.html">Reference Manual</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-package_reference'>
		<h5>package reference</h5>
		<div class='pBody'>
			<ul>
				<li id="n-XDCtools-packages"><a href="http://rtsc.eclipse.org/cdoc-tip/index.html ">XDCtools packages</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-lists'>
		<h5>lists</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Master-doc-map"><a href="../Special:DocMap/Special:DocMap__Main_Page.html">Master doc-map</a></li>
				<li id="n-Category-query"><a href="../Special:Cats/Special:Cats.html">Category query</a></li>
				<li id="n-Redirected-pages"><a href="../Special:Listredirects/Special:Listredirects.html">Redirected pages</a></li>
			</ul>
		</div>
	</div>
		<div class='portlet' id='p-tools'>
		<h5>tools</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Find.2BReplace-.28grep.29"><a href="../Special:Grep/Special:Grep.html">Find+Replace (grep)</a></li>
				<li id="n-RSS-feed"><a href="http://rtsc.eclipse.orgmediawiki-tip/index.php?title=Special:Recentchanges&amp;feed=rss ">RSS feed</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/docs-tip/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search RTSC-Pedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>more tools</h5>
		<div class="pBody">
			<ul>
<li id="t-upload"><a href="../Special:Upload/Special:Upload.html" title="Upload images or media files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="../Special:Specialpages/Special:Specialpages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../common/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="privacy"><a href="../RTSC-Pedia:Privacy_policy/RTSC-Pedia:Privacy_policy.html" title="RTSC-Pedia:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="../RTSC-Pedia:About/RTSC-Pedia:About.html" title="RTSC-Pedia:About">About RTSC-Pedia</a></li>
				<li id="disclaimer"><a href="../RTSC-Pedia:General_disclaimer/RTSC-Pedia:General_disclaimer.html" title="RTSC-Pedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served in 0.318 secs. --></body></html>
