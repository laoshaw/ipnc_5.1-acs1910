# (c) Texas Instruments 

ifndef $(COMMON_HEADER_MK)
COMMON_HEADER_MK = 1

CC=$(BUILD_TOOL_PREFIX)gcc
AR=$(BUILD_TOOL_PREFIX)ar
LD=$(BUILD_TOOL_PREFIX)gcc

LIB_BASE_DIR=$(AVCAPTURE_BUILD_DIR)/lib
OBJ_BASE_DIR=$(AVCAPTURE_BUILD_DIR)/obj
EXE_BASE_DIR=$(AVCAPTURE_BUILD_DIR)/../bin

LIB_DIR=$(LIB_BASE_DIR)/$(APP_BUILD_CFG)
EXE_DIR=$(EXE_BASE_DIR)/$(APP_BUILD_CFG)
OBJ_DIR=$(OBJ_BASE_DIR)/$(MODULE)/$(APP_BUILD_CFG)

ifeq ($(IMGS_ID), IMGS_MC1208_2MP)
	VIM_LIB=$(AVCAPTURE_BUILD_DIR)/../framework/drv/usermod/src/imgs_MC1208_2MP/VIM_API/libvc0710_isp.a
endif

CC_OPTS=-c -Wall -fPIC

ifeq ($(APP_BUILD_CFG), debug)

CC_OPTS+=-g
OPTI_OPTS=
DEFINE=-DDEBUG

else

CC_OPTS+= -Dxdc_target_types__=gnu/targets/arm/std.h
OPTI_OPTS=-O3
DEFINE=

endif

ifeq ($(TREAT_WARNINGS_AS_ERROR), yes)
CC_OPTS += -Werror 
else
CC_OPTS += -w
endif

ifeq ($(IPNC_DEVICE), DM369)
DEFINE+=-DTNF3_MODE_ON
endif

ifeq ($(IPNC_DEVICE), DMVA1)
DEFINE+=-DDMVA_CHIP
endif

ifeq ($(IPNC_DEVICE), DMVA2)
DEFINE+=-DDMVA_CHIP
endif

DEFINE+=-D$(BOARD_ID)
DEFINE+=-D$(IMGS_ID)

ifeq ($(IMGS_ID), IMGS_TVP514X)
DEFINE+=-DYUV_MODE
DEFINE+=-DYUV_MODE_INTERLACED
endif

ifeq ($(IMGS_ID), IMGS_MICRON_MT9D131_2MP)
DEFINE+=-DYUV_MODE
DEFINE+=-DYUV_MODE_PROGRESSIVE
endif

ifeq ($(IMGS_ID), IMGS_OV9712_5MP)
DEFINE+=-DIMGS_OV
DEFINE+=-DIMGS_OV9712
endif

ifeq ($(IMGS_ID), IMGS_MICRON_MT9M034_1.2MP)
DEFINE+=-DIMGS_M034
endif

ifeq ($(IMGS_ID), IMGS_AR0331_3.1MP_WDR)
DEFINE+=-DAR0331_WDR
endif

ifeq ($(IMGS_ID), IMGS_AR0331_3.1MP)
DEFINE+=-DIMGS_AR0331
endif

ifeq ($(IMGS_ID), IMGS_OV2715_2MP)
DEFINE+=-DIMGS_OV
endif

ifeq ($(IMGS_ID), IMGS_OV10630_1MP)
DEFINE+=-DYUV_MODE
DEFINE+=-DYUV_MODE_PROGRESSIVE
DEFINE+=-DOV10630
endif

ifeq ($(IMGS_ID), IMGS_OV10635_1MP)
DEFINE+=-DYUV_MODE
DEFINE+=-DYUV_MODE_PROGRESSIVE
DEFINE+=-DOV10635
endif

ifeq ($(IMGS_ID), IMGS_MC1208_2MP)
DEFINE+=-DYUV_MODE
DEFINE+=-DYUV_MODE_PROGRESSIVE
DEFINE+=-DMC1208
endif

ifeq ($(WIFI_MODULE_MODE), ON)
DEFINE+=-DWIFI_MODE_ON
endif

ifeq ($(FACE_RECOG_MODE), ON)
DEFINE+=-DFACE_RECOG_ENABLE
endif

AR_OPTS=-rc
LD_OPTS=-lpthread -lpng -fPIC -lasound -s -Wl,-Map=av_server.map

FILES=$(subst ./, , $(foreach dir,.,$(wildcard $(dir)/*.c)) ) 

vpath %.a $(LIB_DIR) 

include $(AVCAPTURE_BUILD_DIR)/INCLUDES.MK

INCLUDE=
INCLUDE+=$(KERNEL_INC)
INCLUDE+=$(COMMON_INC)
INCLUDE+=$(OSA_INC) 
INCLUDE+=$(CMEM_INC) 
INCLUDE+=$(CSL_INC) 
INCLUDE+=$(DRV_INC) 
INCLUDE+=$(DMVAL_INC) 

endif # ifndef $(COMMON_HEADER_MK)

